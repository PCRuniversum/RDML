<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using RDML with other R packages • RDML</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">RDML</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kablag/RDML">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Using RDML with other R packages</h1>
                        <h4 class="author">Konstantin A. Blagodatskikh, Michał Burdukiewicz, Stefan Rödiger</h4>
            
            <h4 class="date">2017-07-23</h4>
          </div>

    
    
<div class="contents">
<div id="practical-example-for-the-usage-of-the-rmdl-package" class="section level1">
<h1 class="hasAnchor">
<a href="#practical-example-for-the-usage-of-the-rmdl-package" class="anchor"></a>Practical Example for the Usage of the <strong>RMDL</strong> package</h1>
<p>A key benefit of the <strong>RMDL</strong> package is that it enables further statistical analysis of RDML data. This section provides <strong>R</strong> packages that link with the <strong>RMDL</strong> package. Moreover, it will give an example how other packages allow the manipulation of RDML objects.</p>
<p>In this example we will use the <strong>qpcR</strong> package <span class="citation">(Ritz and Spiess 2008)</span> to calculate the Cq values after the selction of an optimal sigmoidal model as suggested by the Akaike’s An Information Criterion. The Cq value will be used to calculate the amplification efficiency from a calibration curve. The <code>effcalc</code> function from the <strong>chipPCR</strong> package <span class="citation">(Rödiger, Burdukiewicz, and Schierack 2015)</span> will be used for this task.</p>
<p>Note: The data used here sereve as an example only. Overall, the quality of the measurement is not appropriate for a further usage in a study. Here, we shwo that estimated amplification efficiency estimated by the StepOne system differs from the estimate as analyzed with the proposed pipeline (<strong>RDML</strong> <span class="math inline">\(\rightarrow\)</span> <strong>qpcR</strong> <span class="math inline">\(\rightarrow\)</span> <strong>chipPCR</strong>).</p>
<div id="preparation-of-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparation-of-the-data" class="anchor"></a>Preparation of the data</h2>
<p>In section [xyz] it was shown how to read-in RDML data. In this section we will continoue with the built-in RDML example file <code>stepone_std.rdml</code>. This file was obtained during the measurement of human DNA concentration by a <em>LightCycler 96</em> (Roche) and the <em>XY-Detect</em> kit (Syntol, Russia). The file is opened as described before:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RDML)
filename &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"extdata/stepone_std.rdml"</span>, <span class="dt">package =</span> <span class="st">"RDML"</span>)
raw_data &lt;-<span class="st"> </span>RDML$<span class="kw"><a href="../reference/new-method.html">new</a></span>(<span class="dt">filename =</span> filename)</code></pre></div>
<p>For convenice we use the pipe function <code>%&gt;%</code> from the <strong>magrittr</strong> package for further analysis. Next we fetch the amplification curve data from the RDML file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(magrittr)
raw_data_tab &lt;-<span class="st"> </span>raw_data$<span class="kw"><a href="../reference/astable-function.html">AsTable</a></span>(
    <span class="co"># Custom name pattern 'position~sample~sample.type~target~run.id'</span>
    <span class="dt">name.pattern =</span> <span class="kw">paste</span>(
        react$position,
        react$sample$id,
        private$.sample[[react$sample$id]]$type$value,
        data$tar$id,
        run$id$id, <span class="co"># run id added to names</span>
        <span class="dt">sep =</span> <span class="st">"~"</span>))
<span class="co"># Get all fluorescence data and assign them to the object fdata</span>
fdata &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(raw_data$<span class="kw"><a href="../reference/GetFData-function.html">GetFData</a></span>(raw_data_tab, <span class="dt">long.table =</span> <span class="ot">FALSE</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the ggplot2 package for plotting</span>
<span class="kw">library</span>(ggplot2)
<span class="co"># Load the reshape2 package to rearrange the data</span>
<span class="kw">library</span>(reshape2)
<span class="co"># Rearrange and plot the raw data</span>
fdata_gg &lt;-<span class="st"> </span><span class="kw">melt</span>(fdata, <span class="dt">id.vars=</span><span class="st">"cyc"</span>)
<span class="kw">ggplot</span>(<span class="dt">data=</span>fdata_gg, <span class="kw">aes</span>(<span class="dt">x=</span>cyc, <span class="dt">y=</span>value, <span class="dt">color=</span>variable)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>() +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"Cycle"</span>, <span class="dt">y=</span><span class="st">"RFU"</span>) +<span class="st"> </span><span class="kw">theme_light</span>() +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">"top"</span>,
    <span class="dt">legend.direction=</span><span class="st">"horizontal"</span>)</code></pre></div>
<p><img src="usingRDML_with_other_R_packages_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p>During the next steps comes the <strong>qpcR</strong> package into use. The function <code>mselect</code> performs a sigmoidal model selection by different criteria (e.g., bias-corrected Akaike’s Information Criterion). The function <code>efficiency</code> calculates the qPCR Cq values, amplification efficiency and other important qPCR parameters. In this example we set the parameter type of the <code>efficiency</code> funtion to <code>Cy0</code>. This will calculate the Cy0 value, which is the intersection of a tangent on the first derivative maximum with the abscissa as calculated according to <span class="citation">Guescini et al. (2008)</span>.</p>
<p>The <code>effcalc</code> function was used to determine the coefficients of the calibration curve.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(chipPCR)

res_efficiency &lt;-<span class="st"> </span><span class="kw">effcalc</span>(dilution[-<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>)], Cq_values[-<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>), ], <span class="dt">logx=</span><span class="ot">FALSE</span>)

res_efficiency %&gt;%<span class="st"> </span><span class="kw">plot</span>(., <span class="dt">CI=</span><span class="ot">TRUE</span>, <span class="dt">main=</span><span class="st">"Second Derivative Maximum Method"</span>)</code></pre></div>
<p><img src="usingRDML_with_other_R_packages_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Combine the sample labels and the Cq values as calculate by the Second Derivative Maximum Method (cpD2).</span>
sample_Cq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample=</span><span class="kw">c</span>(<span class="st">"ntc"</span>, <span class="st">"unk"</span>, <span class="dv">10000</span>, <span class="dv">5000</span>, <span class="dv">2500</span>, <span class="dv">1250</span>, <span class="dv">625</span>), Cq_values)

<span class="co"># Print table of all Cq values</span>
knitr::<span class="kw">kable</span>(sample_Cq, <span class="dt">caption=</span><span class="st">"Cq values as calculate by the </span>
<span class="st">                        Second Derivative Maximum Method (cpD2)."</span>)</code></pre></div>
<table class="table">
<caption>Cq values as calculate by the Second Derivative Maximum Method (cpD2).</caption>
<thead><tr class="header">
<th align="left">sample</th>
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ntc</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">unk</td>
<td align="right">28.38</td>
<td align="right">28.30</td>
<td align="right">28.42</td>
</tr>
<tr class="odd">
<td align="left">10000</td>
<td align="right">27.39</td>
<td align="right">27.38</td>
<td align="right">27.30</td>
</tr>
<tr class="even">
<td align="left">5000</td>
<td align="right">26.21</td>
<td align="right">26.20</td>
<td align="right">26.24</td>
</tr>
<tr class="odd">
<td align="left">2500</td>
<td align="right">27.28</td>
<td align="right">27.32</td>
<td align="right">27.32</td>
</tr>
<tr class="even">
<td align="left">1250</td>
<td align="right">28.38</td>
<td align="right">28.41</td>
<td align="right">28.33</td>
</tr>
<tr class="odd">
<td align="left">625</td>
<td align="right">29.42</td>
<td align="right">29.47</td>
<td align="right">29.54</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">kable</span>(res_efficiency, <span class="dt">caption=</span><span class="st">"Analysis of the amplification efficiency."</span>)</code></pre></div>
<table class="table">
<caption>Analysis of the amplification efficiency.</caption>
<thead><tr class="header">
<th align="right">Concentration</th>
<th align="right">Location (Mean)</th>
<th align="right">Deviation (SD)</th>
<th align="right">Coefficient of Variance (RSD [%])</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">5000</td>
<td align="right">26.21667</td>
<td align="right">0.0208167</td>
<td align="right">0.0007940</td>
</tr>
<tr class="even">
<td align="right">2500</td>
<td align="right">27.30667</td>
<td align="right">0.0230940</td>
<td align="right">0.0008457</td>
</tr>
<tr class="odd">
<td align="right">1250</td>
<td align="right">28.37333</td>
<td align="right">0.0404145</td>
<td align="right">0.0014244</td>
</tr>
<tr class="even">
<td align="right">625</td>
<td align="right">29.47667</td>
<td align="right">0.0602771</td>
<td align="right">0.0020449</td>
</tr>
</tbody>
</table>
<p>The Cq values (28.38, 28.3, 28.42) from the unkown sample <code>unk</code> had an average Cq of 28.37 ± 0.06.</p>
<p>(and, if not, is this ever a problem?)</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-guescini_new_2008">
<p>Guescini, Michele, Davide Sisti, Marco BL Rocchi, Laura Stocchi, and Vilberto Stocchi. 2008. “A New Real-Time PCR Method to Overcome Significant Quantitative Inaccuracy Due to Slight Amplification Inhibition.” <em>BMC Bioinformatics</em> 9 (1): 326. doi:<a href="https://doi.org/10.1186/1471-2105-9-326">10.1186/1471-2105-9-326</a>.</p>
</div>
<div id="ref-ritz_qpcr_2008">
<p>Ritz, Christian, and Andrej-Nikolai Spiess. 2008. “qpcR: An R Package for Sigmoidal Model Selection in Quantitative Real-Time Polymerase Chain Reaction Analysis.” <em>Bioinformatics</em> 24 (13): 1549–51. doi:<a href="https://doi.org/10.1093/bioinformatics/btn227">10.1093/bioinformatics/btn227</a>.</p>
</div>
<div id="ref-roediger2015chippcr">
<p>Rödiger, Stefan, Michał Burdukiewicz, and Peter Schierack. 2015. “chipPCR: an R package to pre-process raw data of amplification curves.” <em>Bioinformatics</em> 31 (17): 2900–2902. <a href="https://bioinformatics.oxfordjournals.org/content/31/17/2900.abstract" class="uri">https://bioinformatics.oxfordjournals.org/content/31/17/2900.abstract</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      true
    </div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Konstantin A. Blagodatskikh, Stefan Roediger, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
