<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using RDML with other R packages • RDML</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using RDML with other R packages">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RDML</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RDML.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CreateRDML.html">Creating RDML file from raw data</a>
    </li>
    <li>
      <a href="../articles/usingRDML_with_other_R_packages.html">Using RDML with other R packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PCRuniversum/RDML">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PCRuniversum/RDML/blob/master/vignettes/usingRDML_with_other_R_packages.Rmd"><code>vignettes/usingRDML_with_other_R_packages.Rmd</code></a></small>
      <div class="hidden name"><code>usingRDML_with_other_R_packages.Rmd</code></div>

    </div>

    
    
<div id="a-practical-example-for-usage-of-the-rmdl-package" class="section level1">
<h1 class="hasAnchor">
<a href="#a-practical-example-for-usage-of-the-rmdl-package" class="anchor"></a>A Practical Example for Usage of the <strong>RMDL</strong> package</h1>
<p>A key benefit of the <strong>RMDL</strong> package is that it enables further statistical analysis of RDML data. This section describes <strong>R</strong> packages that link with the <strong>RMDL</strong> package. It will provide examples on how other packages allow the manipulation of RDML objects.</p>
<p>In this example we will employ the <strong>qpcR</strong> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="ritz_qpcr_2008"><strong>???</strong></span>)</span> to calculate Cq values after the selection of an optimal sigmoidal model, as suggested by the Akaike’s An Information Criterion. The Cq values will then be used to calculate the amplification efficiency from a calibration curve, based on the <code>effcalc</code> function of the <strong>chipPCR</strong> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="roediger2015chippcr"><strong>???</strong></span>)</span>.</p>
<p>Note: The data used here serve as example only. Overall, the quality of the measurement is not appropriate for further application in a study. Here, we show that the estimated amplification efficiency from the StepOne system differs from that of the proposed pipeline (<strong>RDML</strong> <span class="math inline">\(\rightarrow\)</span> <strong>qpcR</strong> <span class="math inline">\(\rightarrow\)</span> <strong>chipPCR</strong>).</p>
<p>In principle, the following code examples can be combined with report generating toolkits for data analysis pipelines, such as <strong>Nozzle</strong> (see <span class="citation">(<span class="citeproc-not-found" data-reference-id="gehlenborg_nozzle:_2013"><strong>???</strong></span>)</span>).</p>
</div>
<div id="preparation-of-the-data" class="section level1">
<h1 class="hasAnchor">
<a href="#preparation-of-the-data" class="anchor"></a>Preparation of the data</h1>
<p>In the <strong>RDML</strong> vignette, it was demonstrated how to read-in RDML data. In this section we will continue with the built-in RDML example file <code>stepone_std.rdml</code>. This file was obtained during the measurement of human DNA concentration by a <em>LightCycler 96</em> instrument (Roche) and the <em>XY-Detect</em> kit (Syntol, Russia). The file is opened as described before:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Load the RDML package and use its functions to `extract` the required data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(RDML)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">filename &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/stepone_std.rdml"</span>, <span class="dt">package=</span><span class="st">"RDML"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">raw_data &lt;-<span class="st"> </span>RDML<span class="op">$</span><span class="kw"><a href="../reference/new-method.html">new</a></span>(<span class="dt">filename=</span>filename)</a></code></pre></div>
</div>
<div id="working-with-metadata-of-the-example-file" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-metadata-of-the-example-file" class="anchor"></a>Working with metadata of the example file</h1>
<p>At this stage, all data from the <code>stepone_std.rdml</code> RDML file are available. For example, the amplification efficiency as provided by the StepOne™ Real-Time PCR System software can be fetched from the package via <code>raw_data$target[["RNase  P"]]$amplificationEfficiency</code>. In another example, we extract the information about the target in this experiment.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">raw_data<span class="op">$</span>target</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; $`RNase P`</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;  id: ~ idType</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;  description: NFQ-MGB</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt;  documentation: []</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt;  xRef: []</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  type: ~ targetTypeType</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  amplificationEfficiencyMethod: </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  amplificationEfficiency: 93.91181</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt;  amplificationEfficiencySE: </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt;  detectionLimit: </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt;  dyeId: ~ idReferencesType</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt;  sequences: ~ sequencesType</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt;  commercialAssay:</span></a></code></pre></div>
<p>To get some information about the run we can use:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">raw_data<span class="op">$</span>experiment[[<span class="st">"Standard Curve Example"</span>]]<span class="op">$</span>run</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; $Run001</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;  id: ~ idType</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;  description: </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  documentation: []</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt;  experimenter: []</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt;  instrument: Applied Biosystems StepOne™ Instrument</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt;  dataCollectionSoftware: ~ dataCollectionSoftwareType</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt;  backgroundDeterminationMethod: Background Subtraction</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt;  cqDetectionMethod: ~ cqDetectionMethodType</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;  thermalCyclingConditions: ~ idReferencesType</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;  pcrFormat: ~ pcrFormatType</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  runDate: 2006-11-10T09:24:39.265</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  react: [1, 2, 3, 4, 5, 6, 7, 8, 13, 14, 15, 16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32]</span></a></code></pre></div>
</div>
<div id="extraction-of-raw-amplification-curve-data" class="section level1">
<h1 class="hasAnchor">
<a href="#extraction-of-raw-amplification-curve-data" class="anchor"></a>Extraction of raw amplification curve data</h1>
<p>For convenience, we use the pipe function <code><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></code> from the <strong>magrittr</strong> package for further analysis. In the following, we fetch the amplification curve data from the RDML file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">raw_data_tab &lt;-<span class="st"> </span>raw_data<span class="op">$</span><span class="kw"><a href="../reference/astable-function.html">AsTable</a></span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="co"># Custom name pattern 'position~sample~sample.type~target~run.id'</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">    <span class="dt">name.pattern=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        react<span class="op">$</span>position,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        react<span class="op">$</span>sample<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">        private<span class="op">$</span>.sample[[react<span class="op">$</span>sample<span class="op">$</span>id]]<span class="op">$</span>type<span class="op">$</span>value,</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">        data<span class="op">$</span>tar<span class="op">$</span>id,</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">        run<span class="op">$</span>id<span class="op">$</span>id, <span class="co"># run id added to names</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">        <span class="dt">sep=</span><span class="st">"~"</span>))</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co"># Get all fluorescence data and assign them to the object fdata</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">fdata &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(raw_data<span class="op">$</span><span class="kw"><a href="../reference/GetFData-function.html">GetFData</a></span>(raw_data_tab, <span class="dt">long.table=</span><span class="ot">FALSE</span>))</a></code></pre></div>
</div>
<div id="plotting-of-raw-amplification-curve-data" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-of-raw-amplification-curve-data" class="anchor"></a>Plotting of raw amplification curve data</h1>
<p>The plotting of the raw data is an important step to visually inspect the data. In this example, we use the <strong>ggplot2</strong> package <span class="citation">(<span class="citeproc-not-found" data-reference-id="wickham_ggplot2_2009"><strong>???</strong></span>)</span> instead of the default <strong>R</strong> graphics functions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Load the ggplot2 package for plotting</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># Load the reshape2 package to rearrange the data</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(reshape2)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># Rearrange and plot the raw data</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">fdata_gg &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span>(fdata, <span class="dt">id.vars=</span><span class="st">"cyc"</span>)</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="dt">data=</span>fdata_gg, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x=</span>cyc, <span class="dt">y=</span>value, <span class="dt">color=</span>variable)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x=</span><span class="st">"Cycle"</span>, <span class="dt">y=</span><span class="st">"RFU"</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.position=</span><span class="st">"top"</span>,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">    <span class="dt">legend.direction=</span><span class="st">"horizontal"</span>)</a></code></pre></div>
<p><img src="usingRDML_with_other_R_packages_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="analysis-of-the-qpcr-amplification-curve-data-by-a-custom-made-function" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-the-qpcr-amplification-curve-data-by-a-custom-made-function" class="anchor"></a>Analysis of the qPCR amplification curve data by a custom made function</h1>
<p>During the next steps we will employ the <strong>qpcR</strong> package. The function <code>mselect</code> performs sigmoid model selection by different criteria (e.g., bias-corrected Akaike’s Information Criterion). Note: In most cases a sigmoidal model with seven parameters was selected.</p>
<p>The function <code>efficiency</code> calculates the qPCR Cq values, amplification efficiency and other important qPCR parameters. In this example, we set the parameter type of the <code>efficiency</code> function to <code>Cy0</code>, which will calculate and report the Cy0 value. According to <span class="citation">(<span class="citeproc-not-found" data-reference-id="guescini_new_2008"><strong>???</strong></span>)</span>, the Cy0 value is the intersection of a tangent on the first derivative maximum with the abscissa. However, for all further analyses we will use the second derivative maximum cycle as Cq value. This supplementary material will not focus on the selection of a certain Cq method. For an objective decision, we would like to guide the reader to the study by <span class="citation">(<span class="citeproc-not-found" data-reference-id="ruijter_evaluation_2013"><strong>???</strong></span>)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Use the magrittr package to create pipes</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Write a custom function that calculates the Cq values and other curve parameters</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(qpcR)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; Loading required package: MASS</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Loading required package: minpack.lm</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; Loading required package: rgl</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; Loading required package: robustbase</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">res_fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span>(cbind, <span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(2L<span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(fdata), <span class="cf">function</span>(block_column) {</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">    </a>
<a class="sourceLine" id="cb6-13" data-line-number="13">    res_model &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/qpcR/man/mselect.html">mselect</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/qpcR/man/pcrfit.html">pcrfit</a></span>(<span class="dt">data=</span>fdata, <span class="dt">cyc=</span><span class="dv">1</span>, <span class="dt">fluo=</span>block_column), <span class="dt">verbose=</span><span class="ot">FALSE</span>, <span class="dt">do.all=</span><span class="ot">TRUE</span>), <span class="dt">silent=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">    <span class="cf">if</span>(res_model <span class="op">%&gt;%</span><span class="st"> </span>class<span class="op">==</span><span class="st">"try-error"</span>) {</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">        res_model &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">    }</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">    <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">        <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span>(<span class="kw"><a href="https://rdrr.io/pkg/qpcR/man/efficiency.html">efficiency</a></span>(res_model, <span class="dt">plot=</span><span class="ot">FALSE</span>, <span class="dt">type=</span><span class="st">"Cy0"</span>), <span class="dt">silent=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">    }</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">        }</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">    )</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">)</a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co"># Assign column names</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(res_fit) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(fdata)[<span class="op">-</span><span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-25" data-line-number="25"></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co"># Fetch only the Cq values (second derivative maximum) and combine them in a</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co"># data.frame</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"></a>
<a class="sourceLine" id="cb6-29" data-line-number="29">Cq_SDM &lt;-<span class="st"> </span>res_fit[<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(res_fit)<span class="op">==</span><span class="st">"cpD2"</span>, ] <span class="op">%&gt;%</span><span class="st"> </span>unlist <span class="op">%&gt;%</span><span class="st"> </span>as.data.frame</a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Cq_SDM) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Cq"</span>)</a>
<a class="sourceLine" id="cb6-31" data-line-number="31"></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co"># Prepare the dilutions and calculated Cq values for further usage in the effcalc</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co"># function from the chipPCR package</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"></a>
<a class="sourceLine" id="cb6-35" data-line-number="35">dilution &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="st">"ntc"</span>), <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(<span class="st">"unk"</span>), <span class="dv">10000</span>, <span class="dv">5000</span>, <span class="dv">2500</span>, <span class="dv">1250</span>, <span class="dv">625</span>)</a>
<a class="sourceLine" id="cb6-36" data-line-number="36">Cq_values &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(Cq_SDM[, <span class="st">"Cq"</span>], <span class="dt">nrow=</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(dilution), <span class="dt">ncol=</span><span class="dv">3</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="inspection-and-interpretation-of-the-analyzed-data" class="section level1">
<h1 class="hasAnchor">
<a href="#inspection-and-interpretation-of-the-analyzed-data" class="anchor"></a>Inspection and interpretation of the analyzed data</h1>
<p>Below, we arbitarily selected a non-template control (negative) and an unknown sample (positive) (two out of 24 amplification curves) for the presentation of the coefficients that were calculated from the raw amplication curve data.</p>
<table class="table">
<caption>Selected data of calculated values from the fitted models. The values reported in the table were calculated by a chain of functions from the <strong>qpcR</strong> package. In detail, this were the <em>mselect</em> function to calculate the optimal multiparametric sigmoid model and the <em>efficiency</em> function to calculate the Cq values and other curve parameters. More information about these functions is available from the manual of the <strong>qpcR</strong> package. The samples <code>A01</code> (ntc, non-template cntrol) and <code>A05</code> (unk, unknown) were arbitrarily selected for presentation. The custom made function assigned a NA (not available) to sample <code>A01</code> because no Cq value or other curve parameters could be calculated from the non-template control.</caption>
<thead><tr class="header">
<th></th>
<th align="left">A01~NTC_RNase P<sub>ntc</sub>RNase P~Run001</th>
<th align="left">A05~pop1_RNase P<sub>unkn</sub>RNase P~Run001</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>eff</td>
<td align="left">NA</td>
<td align="left">1.01020429599186</td>
</tr>
<tr class="even">
<td>resVar</td>
<td align="left">NA</td>
<td align="left">7.27e-06</td>
</tr>
<tr class="odd">
<td>AICc</td>
<td align="left">NA</td>
<td align="left">-347.935408836544</td>
</tr>
<tr class="even">
<td>AIC</td>
<td align="left">NA</td>
<td align="left">-351.435408836544</td>
</tr>
<tr class="odd">
<td>Rsq</td>
<td align="left">NA</td>
<td align="left">0.999986082849537</td>
</tr>
<tr class="even">
<td>Rsq.ad</td>
<td align="left">NA</td>
<td align="left">0.999983552458544</td>
</tr>
<tr class="odd">
<td>cpD1</td>
<td align="left">NA</td>
<td align="left">32.13</td>
</tr>
<tr class="even">
<td>cpD2</td>
<td align="left">NA</td>
<td align="left">28.3</td>
</tr>
<tr class="odd">
<td>cpE</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td>cpR</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td>cpT</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td>Cy0</td>
<td align="left">NA</td>
<td align="left">24.95</td>
</tr>
<tr class="odd">
<td>cpCQ</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td>cpMR</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td>fluo</td>
<td align="left">NA</td>
<td align="left">0.669107426735924</td>
</tr>
<tr class="even">
<td>init1</td>
<td align="left">NA</td>
<td align="left">0.641678574633849</td>
</tr>
<tr class="odd">
<td>init2</td>
<td align="left">NA</td>
<td align="left">0.519380971518155</td>
</tr>
<tr class="even">
<td>cf</td>
<td align="left">NA</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="calculation-of-the-amplication-efficiency-from-calibration-data" class="section level1">
<h1 class="hasAnchor">
<a href="#calculation-of-the-amplication-efficiency-from-calibration-data" class="anchor"></a>Calculation of the amplication efficiency from calibration data</h1>
<p>We now use our calculated Cq values from the dilutions steps (625, 1250, 2500, 5000, 10^{4}) to determine the efficiency from the calibration curve. According to the StepOne software, the amplification efficiency is approx. 93.9%. To confirm these results, the <code>effcalc</code> function was employed to determine the coefficients of the calibration curve.</p>
<p>The following few lines are needed to calculate the amplication efficiency based on the previously calculated Cq values.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Load the chipPCR package</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(chipPCR)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># Use the effcalc function from the chipPCR package to calculate the amplification</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co"># efficiency and store the results in the object res_efficiency</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">res_efficiency &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/chipPCR/man/effcalc.html">effcalc</a></span>(dilution[<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)], Cq_values[<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), ], <span class="dt">logx=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co"># Use the %&gt;% function from the magrittr package to plot the results (res_efficiency) </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># from the effcalc function </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">res_efficiency <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(., <span class="dt">CI=</span><span class="ot">TRUE</span>, <span class="dt">ylab=</span><span class="st">"Cq (SDM)"</span>, </a>
<a class="sourceLine" id="cb7-13" data-line-number="13">                        <span class="dt">main=</span><span class="st">"Second Derivative Maximum Method"</span>)</a></code></pre></div>
<p><img src="usingRDML_with_other_R_packages_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The amplification efficiency estimated with the customized function was 94.7%, which is comparable to the value reported in the <code>stepone_std.rdml</code> file.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Combine the sample labels and the Cq values as calculate by the Second </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># Derivative Maximum Method (cpD2).</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">sample_Cq &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sample=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ntc"</span>, <span class="st">"unk"</span>, </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">                                 <span class="dv">10000</span>, <span class="dv">5000</span>, <span class="dv">2500</span>, <span class="dv">1250</span>, <span class="dv">625</span>), </a>
<a class="sourceLine" id="cb8-6" data-line-number="6">                        Cq_values)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co"># Print table of all Cq values</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co"># Use the kable function from the knitr package to print a table</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"></a>
<a class="sourceLine" id="cb8-11" data-line-number="11">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(sample_Cq, <span class="dt">caption=</span><span class="st">"Cq values as calculate by the Second Derivative </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">Maximum Method (cpD2). ntc, non-template control. unk, unknown sample. X1, X2 </span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">and X3 are the Cq values from a triplicate measurement."</span>)</a></code></pre></div>
<table class="table">
<caption>Cq values as calculate by the Second Derivative Maximum Method (cpD2). ntc, non-template control. unk, unknown sample. X1, X2 and X3 are the Cq values from a triplicate measurement.</caption>
<thead><tr class="header">
<th align="left">sample</th>
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">ntc</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">unk</td>
<td align="right">28.38</td>
<td align="right">28.30</td>
<td align="right">28.42</td>
</tr>
<tr class="odd">
<td align="left">10000</td>
<td align="right">27.39</td>
<td align="right">27.38</td>
<td align="right">27.30</td>
</tr>
<tr class="even">
<td align="left">5000</td>
<td align="right">26.21</td>
<td align="right">26.20</td>
<td align="right">26.24</td>
</tr>
<tr class="odd">
<td align="left">2500</td>
<td align="right">27.28</td>
<td align="right">27.32</td>
<td align="right">27.32</td>
</tr>
<tr class="even">
<td align="left">1250</td>
<td align="right">28.38</td>
<td align="right">28.41</td>
<td align="right">28.33</td>
</tr>
<tr class="odd">
<td align="left">625</td>
<td align="right">29.42</td>
<td align="right">29.47</td>
<td align="right">29.54</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(res_efficiency, <span class="dt">caption=</span><span class="st">"Analysis of the amplification efficiency. </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">The table reports the concentration-depentent average Cq values from three </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">replicates per dilution step. In addition, the standard deviation (SD) and the </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">Coefficient of Variation (RSD [%]) are presented. The results indicate that the </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">data basis for the calibration curve is valid."</span>)</a></code></pre></div>
<table class="table">
<caption>Analysis of the amplification efficiency. The table reports the concentration-depentent average Cq values from three replicates per dilution step. In addition, the standard deviation (SD) and the Coefficient of Variation (RSD [%]) are presented. The results indicate that the data basis for the calibration curve is valid.</caption>
<thead><tr class="header">
<th align="right">Concentration</th>
<th align="right">Location (Mean)</th>
<th align="right">Deviation (SD)</th>
<th align="right">Coefficient of Variance (RSD [%])</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">3.69897</td>
<td align="right">26.21667</td>
<td align="right">0.0208167</td>
<td align="right">0.0007940</td>
</tr>
<tr class="even">
<td align="right">3.39794</td>
<td align="right">27.30667</td>
<td align="right">0.0230940</td>
<td align="right">0.0008457</td>
</tr>
<tr class="odd">
<td align="right">3.09691</td>
<td align="right">28.37333</td>
<td align="right">0.0404145</td>
<td align="right">0.0014244</td>
</tr>
<tr class="even">
<td align="right">2.79588</td>
<td align="right">29.47667</td>
<td align="right">0.0602771</td>
<td align="right">0.0020449</td>
</tr>
</tbody>
</table>
<p>The Cq values (28.38, 28.3, 28.42) from the unknown sample <code>unk</code> had an average Cq of 28.37 ± 0.06.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#a-practical-example-for-usage-of-the-rmdl-package">A Practical Example for Usage of the <strong>RMDL</strong> package</a></li>
      <li><a href="#preparation-of-the-data">Preparation of the data</a></li>
      <li><a href="#working-with-metadata-of-the-example-file">Working with metadata of the example file</a></li>
      <li><a href="#extraction-of-raw-amplification-curve-data">Extraction of raw amplification curve data</a></li>
      <li><a href="#plotting-of-raw-amplification-curve-data">Plotting of raw amplification curve data</a></li>
      <li><a href="#analysis-of-the-qpcr-amplification-curve-data-by-a-custom-made-function">Analysis of the qPCR amplification curve data by a custom made function</a></li>
      <li><a href="#inspection-and-interpretation-of-the-analyzed-data">Inspection and interpretation of the analyzed data</a></li>
      <li><a href="#calculation-of-the-amplication-efficiency-from-calibration-data">Calculation of the amplication efficiency from calibration data</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Konstantin A. Blagodatskikh, Stefan Roediger, Michal Burdukiewicz, Andrej-Nikolai Spiess.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
